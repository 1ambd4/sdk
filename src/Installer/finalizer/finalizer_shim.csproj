<Project TreatAsLocalProperty="Platform">

  <!-- Explicit importing of the SDK so that the SDK targets (Build, Test, Pack, etc) can be overridden after the SDK.targets is imported. -->
  <Import Project="Sdk.props" Sdk="Microsoft.NET.Sdk" />

  <PropertyGroup>
    <BuildArchitecture>$([System.Runtime.InteropServices.RuntimeInformation]::ProcessArchitecture.ToString().ToLowerInvariant())</BuildArchitecture>
    <Architecture Condition="'$(Architecture)' == '' AND ('$(BuildArchitecture)' == 'arm64' OR '$(BuildArchitecture)' == 'arm')">$(BuildArchitecture)</Architecture>
    <Architecture Condition="'$(Architecture)' == '' AND '$(BuildArchitecture)' == 's390x'">$(BuildArchitecture)</Architecture>
    <Architecture Condition="'$(Architecture)' == '' AND '$(BuildArchitecture)' == 'ppc64le'">$(BuildArchitecture)</Architecture>
    <Architecture Condition="'$(Architecture)' == '' AND '$(BuildArchitecture)' == 'loongarch64'">$(BuildArchitecture)</Architecture>
    <Architecture Condition="'$(Architecture)' == ''">x64</Architecture>
  </PropertyGroup>

  <PropertyGroup>
    <TargetFramework>$(SdkTargetFramework)</TargetFramework>
    <NativeVersionFile>$(ArtifactsObjDir)sdk_version.h</NativeVersionFile>
  </PropertyGroup>

  <Target Name="GenerateSdkVersionFile" BeforeTargets="CoreCompile" DependsOnTargets="GenerateNativeVersionFile" />

  <Import Project="Sdk.targets" Sdk="Microsoft.NET.Sdk" />

  <PropertyGroup>
    <Platform Condition="'$(Platform)'=='' Or $(Platform)=='AnyCPU'">$(Architecture)</Platform>
  </PropertyGroup>

  <Target Name="Build" Condition="'$(OS)' == 'Windows_NT' And ('$(Architecture)' == 'x86' Or '$(Architecture)' == 'x64' Or '$(Architecture)' == 'arm64' Or '$(Architecture)' == 'arm')">
    <MSBuild Projects="finalizer2.csproj" Properties="Platform=$(Platform)" Targets="Restore;Build" />
  </Target>

  <Target Name="Test" />
  <Target Name="Pack" />
  <Target Name="Rebuild" />
  <Target Name="IntegrationTest" />
  <Target Name="PerformanceTest" />

</Project>
